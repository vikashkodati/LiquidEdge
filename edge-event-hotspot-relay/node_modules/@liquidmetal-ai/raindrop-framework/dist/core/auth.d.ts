import { JWTVerifyResult } from '@liquidmetal-ai/noway';
import type { KvCache } from '../kv_cache.js';
type Env = {
    LM_AUTH_ALLOWED_ORIGINS: string;
    LM_AUTH_ALLOWED_ISSUERS: string;
    LM_PROVIDER_WORKOS_ORG_ID?: string;
    mem: KvCache;
    jwt?: JWTVerifyResult;
    logger?: {
        info: (msg: string, ...args: unknown[]) => void;
        error: (msg: string, ...args: unknown[]) => void;
    };
};
/**
 * Attempts to validate and decode JWT from Authorization header.
 *
 * Trusted issuers are specified via LM_AUTH_ALLOWED_ISSUERS (comma-separated list).
 * JWKS origin validation is performed against LM_AUTH_ALLOWED_ORIGINS (comma-separated list).
 *
 * Populates env.jwt on successful verification. Always allows request to continue.
 * @param request The incoming request object.
 * @param env The environment object containing auth configuration and mem (a KvCache instance).
 * @returns Always returns true to allow request to continue.
 */
export declare const verifyIssuer: (request: Request, env: Env) => Promise<boolean>;
/**
 * Default authorizer that requires authentication.
 * Checks if a valid JWT exists in env.jwt (populated by verifyIssuer).
 * @param _request The incoming request object (not used in this function).
 * @param env The environment object containing the decoded JWT in env.jwt.
 * @returns True if authenticated (JWT exists), false otherwise.
 */
export declare const requireAuthenticated: (_request: Request, env: Env) => Promise<boolean>;
export {};
//# sourceMappingURL=auth.d.ts.map